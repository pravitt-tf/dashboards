<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comprehensive Financial Plan Dashboard - Redesigned</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7fafc; 
        }
        .kpi-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid #e2e8f0; 
        }
        .kpi-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px -5px rgba(0, 0, 0, 0.07), 0 4px 10px -6px rgba(0, 0, 0, 0.05); 
        }
        .nav-item {
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
            border-bottom: 3px solid transparent;
        }
        .nav-item:hover {
            color: #FFFFFF;
            background-color: #374151; 
            border-bottom-color: #60a5fa; 
        }
        .nav-item.active {
            background-color: #1f2937; 
            color: #FFFFFF;
            border-bottom-color: #2563eb; 
        }
        .table-header th {
            background-color: #f1f5f9; 
            font-weight: 600;
            color: #334155;
        }
        .table-row-even {
            background-color: #f8fafc;
        }
        .table-row-odd {
            background-color: #ffffff;
        }
        .goal-row.hidden-by-filter {
            display: none !important;
        }
        .chart-container {
            position: relative;
            height: 320px; 
            width: 100%;
        }
        .page-content {
            display: none;
        }
        .page-content.active {
            display: block;
        }
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #edf2f7;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #a0aec0;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #718096;
        }
        .interactive-icon {
            cursor: pointer;
            transition: color 0.2s ease-in-out, transform 0.2s ease-in-out;
            color: #d1d5db; 
        }
        .interactive-icon:hover {
            color: #ffffff; 
            transform: scale(1.1);
        }
        .slicer-button {
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            border: 1px solid #d1d5db;
        }
        .slicer-button:hover {
            border-color: #60a5fa;
            color: #2563eb;
        }
        .slicer-button.active {
            background-color: #2563eb; 
            color: white;
            border-color: #2563eb;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .slider-container {
            display: flex;
            align-items: center;
            margin-bottom: 1rem; 
        }
        .slider-container label {
            margin-right: 12px;
            min-width: 130px; 
            color: #4b5563; 
            font-size: 0.875rem;
        }
        .slider-container input[type="range"] {
            flex-grow: 1;
            accent-color: #2563eb; 
            cursor: pointer;
        }
        .slider-container span {
            margin-left: 12px;
            min-width: 70px; 
            text-align: right;
            color: #1f2937; 
            font-weight: 500;
        }
        .card-shadow {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -2px rgba(0, 0, 0, 0.05);
        }
        .insight-box {
            border-left-width: 4px;
            padding: 1rem;
            border-radius: 0.375rem; 
        }
        .insight-box-blue {
            border-color: #3b82f6; 
            background-color: #eff6ff; 
        }
        .insight-box-green {
            border-color: #10b981; 
            background-color: #f0fdf4; 
        }
        .insight-box-yellow {
            border-color: #f59e0b; 
            background-color: #fffbeb; 
        }
        .details-button {
            background-color: #f3f4f6; 
            color: #3b82f6; 
            padding: 0.25rem 0.5rem;
            border-radius: 0.375rem;
            font-size: 0.75rem; 
            transition: background-color 0.2s ease;
        }
        .details-button:hover {
            background-color: #e5e7eb; 
        }
        .details-button i {
            margin-right: 0.25rem;
        }
        #modalGoToPageButton {
            background-color: #10b981; /* emerald-500 */
        }
        #modalGoToPageButton:hover {
            background-color: #059669; /* emerald-600 */
        }

    </style>
</head>
<body class="p-4 md:p-6">

    <div class="max-w-7xl mx-auto bg-white shadow-xl rounded-lg overflow-hidden">

        <!-- NAVBAR -->
        <nav class="bg-gray-800 text-gray-300 p-4">
            <div class="container mx-auto flex flex-wrap justify-between items-center">
                <div class="text-xl font-semibold text-white">Client Financial Plan</div>
                <div class="space-x-3 mt-2 md:mt-0">
                    <button title="Drillthroughs (Demo)" class="interactive-icon" onclick="alert('Global Drillthroughs (Demo)')"><i class="fas fa-chart-pie fa-fw"></i></button>
                    <button title="Slicers (Demo)" class="interactive-icon" onclick="alert('Global Slicers (Demo)')"><i class="fas fa-filter fa-fw"></i></button>
                    <button title="Scenario Sliders (Demo)" class="interactive-icon" onclick="alert('Global Scenario Sliders (Demo)')"><i class="fas fa-sliders fa-fw"></i></button>
                    <button title="Mobile View (Demo)" class="interactive-icon" onclick="alert('Mobile View (Demo)')"><i class="fas fa-mobile-alt fa-fw"></i></button>
                    <button title="PDF Export (Demo)" class="interactive-icon" onclick="alert('PDF export functionality would be implemented here.')"><i class="fas fa-file-pdf fa-fw"></i></button>
                </div>
            </div>
            <div class="mt-4 overflow-x-auto pb-1">
                <ul id="mainNav" class="flex space-x-1 md:space-x-2 text-sm md:text-base">
                    <li class="nav-item active px-4 py-3 rounded-t-md cursor-pointer whitespace-nowrap" data-page="summary">Summary</li>
                    <li class="nav-item px-4 py-3 rounded-t-md cursor-pointer whitespace-nowrap" data-page="goals">Goals</li>
                    <li class="nav-item px-4 py-3 rounded-t-md cursor-pointer whitespace-nowrap" data-page="cashflow">Cash Flow</li>
                    <li class="nav-item px-4 py-3 rounded-t-md cursor-pointer whitespace-nowrap" data-page="loans">Loans</li>
                    <li class="nav-item px-4 py-3 rounded-t-md cursor-pointer whitespace-nowrap" data-page="assets">Assets</li>
                    <li class="nav-item px-4 py-3 rounded-t-md cursor-pointer whitespace-nowrap" data-page="retirement">Retirement</li>
                    <li class="nav-item px-4 py-3 rounded-t-md cursor-pointer whitespace-nowrap" data-page="discretionaryretirement">Discretionary Retirement</li>
                    <li class="nav-item px-4 py-3 rounded-t-md cursor-pointer whitespace-nowrap" data-page="insurance">Insurance</li>
                </ul>
            </div>
        </nav>

        <div class="p-5 md:p-8">
            <!-- SUMMARY PAGE -->
            <div id="pageSummary" class="page-content active">
                <h2 class="text-3xl font-semibold text-gray-800 mb-8">Financial Plan Summary</h2>
                <!-- All Key Performance Indicators are indide this grid -->
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5 md:gap-7 mb-8">
                    <div class="kpi-card bg-green-50 p-5 rounded-xl shadow-md hover:shadow-lg cursor-pointer" onclick="showKPIDetail('Monthly Surplus', '₹1,22,256', 'This is the remaining amount after all monthly expenses are deducted from monthly income. It is calculated as Total Income - Total Expenses.', 'pageCashflow')">
                        <h3 class="text-sm font-medium text-green-700 flex items-center"><i class="fas fa-wallet fa-fw mr-2 text-green-500"></i>Monthly Surplus</h3>
                        <p class="text-3xl font-semibold text-green-800 mt-1">₹1,22,256</p>
                    </div>
                    <div class="kpi-card bg-blue-50 p-5 rounded-xl shadow-md hover:shadow-lg cursor-pointer" onclick="showKPIDetail('Net Worth', '₹2,32,71,913', 'This is the total value of your assets minus your liabilities. It represents your financial standing.', 'pageAssets')">
                        <h3 class="text-sm font-medium text-blue-700 flex items-center"><i class="fas fa-balance-scale fa-fw mr-2 text-blue-500"></i>Net Worth</h3>
                        <p class="text-3xl font-semibold text-blue-800 mt-1">₹2,32,71,913</p>
                    </div>
                    <div class="kpi-card bg-teal-50 p-5 rounded-xl shadow-md hover:shadow-lg cursor-pointer" onclick="showKPIDetail('Insurance Surplus', '₹12,70,46,605', 'This is the surplus amount of life insurance coverage based on Human Life Value (HLV) calculation.', 'pageInsurance')">
                        <h3 class="text-sm font-medium text-teal-700 flex items-center"><i class="fas fa-shield-alt fa-fw mr-2 text-teal-500"></i>Insurance Surplus</h3>
                        <p class="text-3xl font-semibold text-teal-800 mt-1">₹12,70,46,605</p>
                    </div>
                    <div class="kpi-card bg-sky-50 p-5 rounded-xl shadow-md hover:shadow-lg cursor-pointer" onclick="showKPIDetail('Total Assets', '₹2,44,71,913', 'The total value of all financial and non-financial assets owned.', 'pageAssets')">
                        <h3 class="text-sm font-medium text-sky-700 flex items-center"><i class="fas fa-hand-holding-dollar fa-fw mr-2 text-sky-500"></i>Total Assets</h3>
                        <p class="text-3xl font-semibold text-sky-800 mt-1">₹2,44,71,913</p>
                    </div>
                    <div class="kpi-card bg-red-50 p-5 rounded-xl shadow-md hover:shadow-lg cursor-pointer" onclick="showKPIDetail('Total Liabilities', '₹12,00,000', 'The total outstanding amount of all loans and debts.', 'pageLoans')">
                        <h3 class="text-sm font-medium text-red-700 flex items-center"><i class="fas fa-file-invoice-dollar fa-fw mr-2 text-red-500"></i>Total Liabilities</h3>
                        <p class="text-3xl font-semibold text-red-800 mt-1">₹12,00,000</p>
                    </div>
                    <div class="kpi-card bg-amber-50 p-5 rounded-xl shadow-md hover:shadow-lg cursor-pointer" onclick="showKPIDetail('Retirement SIP Gap', '₹0', 'The additional monthly SIP required to meet the retirement corpus goal. A value of zero indicates the current SIP is on track.', 'pageRetirement')">
                        <h3 class="text-sm font-medium text-amber-700 flex items-center"><i class="fas fa-person-cane fa-fw mr-2 text-amber-500"></i>Retirement SIP Gap</h3>
                        <p class="text-3xl font-semibold text-amber-800 mt-1">₹0</p>
                    </div>
                </div>
                <!-- Tax Regime Recommendation Table Card -->
                <div class="mb-8 bg-white p-5 rounded-xl card-shadow">
                    <h3 class="text-xl font-semibold text-gray-700 mb-5">Tax Regime Recommendation</h3>
                    <div class="overflow-x-auto mb-5">
                        <table class="min-w-full text-sm">
                            <thead class="table-header">
                                <tr>
                                    <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Person</th>
                                    <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Recommended Tax Regime</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <tr class="table-row-odd">
                                    <td class="px-5 py-3">Hardik Ganger</td>
                                    <td class="px-5 py-3 text-green-700 font-semibold">New Regime</td>
                                </tr>
                                <tr class="table-row-even">
                                    <td class="px-5 py-3">Chandresh Gangar</td>
                                    <td class="px-5 py-3 text-green-700 font-semibold">New Regime</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="insight-box insight-box-blue card-shadow">
                        <h3 class="text-lg font-semibold text-blue-700 mb-2 flex items-center"><i class="fas fa-lightbulb fa-fw mr-2"></i>Recommendation</h3>
                        <p class="text-blue-600 text-sm">Switching to the New Tax Regime is recommended for both individuals to potentially optimize tax savings based on the current financial structure.</p>
                    </div>
                </div>
                <!-- Grid for Assets and Liabilities charts -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-5 md:gap-7">
                    <!-- Donut Chart for Asset Allocation -->
                    <div class="bg-white p-5 rounded-xl card-shadow">
                        <h3 class="text-xl font-semibold text-gray-700 mb-5">Asset Allocation (Financial Assets)</h3>
                        <div class="chart-container"><canvas id="assetAllocationChart"></canvas></div>
                    </div>
                    <!-- Donut Chart for Liabilities -->
                    <div class="bg-white p-5 rounded-xl card-shadow">
                        <h3 class="text-xl font-semibold text-gray-700 mb-5">Liabilities</h3>
                         <div class="chart-container"><canvas id="liabilitiesChart"></canvas></div>
                    </div>
                </div>
            </div>

            <!-- GOALS PAGE -->
            <div id="pageGoals" class="page-content">
                <h2 class="text-3xl font-semibold text-gray-800 mb-8">Goal Planning</h2>
                <!-- Slicer Buttons Card -->
                <div class="mb-8 p-5 bg-white rounded-xl card-shadow">
                    <h3 class="text-lg font-semibold text-gray-700 mb-4">Filter Goals by Timeline</h3>
                    <div class="flex flex-wrap gap-x-4 gap-y-3">
                         <div class="slicer-group">
                             <div class="flex flex-wrap gap-2">
                                <!-- Buttons that filter the goals based on timeline -->
                                <button class="slicer-button text-gray-700 text-sm py-1.5 px-3.5 rounded-lg" onclick="applyGoalTimelineSlicer('Immediate', this)">Immediate</button>
                                <button class="slicer-button text-gray-700 text-sm py-1.5 px-3.5 rounded-lg" onclick="applyGoalTimelineSlicer('Mid-Term', this)">Mid-Term</button>
                                <button class="slicer-button text-gray-700 text-sm py-1.5 px-3.5 rounded-lg" onclick="applyGoalTimelineSlicer('Long-Term', this)">Long-Term</button>
                                <button class="slicer-button text-gray-700 text-sm py-1.5 px-3.5 rounded-lg active" onclick="applyGoalTimelineSlicer('All', this)">All</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Goal Metrics Table Card -->
                <div class="bg-white p-5 rounded-xl card-shadow">
                    <h3 class="text-xl font-semibold text-gray-700 mb-5">Goal Metrics</h3>
                    <div class="overflow-x-auto">
                        <table id="goalMetricsTable" class="min-w-full">
                            <!-- Header for Goal Metrics Table -->
                            <thead class="table-header">
                                <tr>
                                    <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Goal</th>
                                    <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Target ₹</th>
                                    <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Allocated ₹</th>
                                    <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">SIP ₹</th>
                                    <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Maturity</th>
                                    <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Status</th>
                                </tr>
                            </thead>
                            <tbody class="text-sm">
                                <tr class="table-row-odd goal-row" data-timeline="Long-Term">
                                    <td class="px-5 py-4 whitespace-nowrap">Retirement</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹7,99,90,265</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹3,60,526</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹32,000</td>
                                    <td class="px-5 py-4 whitespace-nowrap">Jul 2052</td>
                                    <td class="px-5 py-4 whitespace-nowrap"><span class="px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Achievable</span></td>
                                </tr>
                                <tr class="table-row-even goal-row" data-timeline="Long-Term">
                                    <td class="px-5 py-4 whitespace-nowrap">Father's Retirement</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹1,29,78,693</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹99,62,972</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹0</td>
                                    <td class="px-5 py-4 whitespace-nowrap">Sep 2028</td>
                                    <td class="px-5 py-4 whitespace-nowrap"><span class="px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Achievable</span></td>
                                </tr>
                                <tr class="table-row-odd goal-row" data-timeline="Mid-Term">
                                    <td class="px-5 py-4 whitespace-nowrap">Annual Obligations</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹75,431</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹0</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹6,500</td>
                                    <td class="px-5 py-4 whitespace-nowrap">Sep 2026</td>
                                    <td class="px-5 py-4 whitespace-nowrap"><span class="px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Achievable</span></td>
                                </tr>
                                <tr class="table-row-even goal-row" data-timeline="Mid-Term">
                                    <td class="px-5 py-4 whitespace-nowrap">Vacation Goal</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹1,00,000</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹0</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹8,500</td>
                                    <td class="px-5 py-4 whitespace-nowrap">Sep 2026</td>
                                    <td class="px-5 py-4 whitespace-nowrap"><span class="px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Achievable</span></td>
                                </tr>
                                <tr class="table-row-odd goal-row" data-timeline="Mid-Term">
                                    <td class="px-5 py-4 whitespace-nowrap">Emergency Fund</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹7,21,716</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹7,21,716</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹0</td>
                                    <td class="px-5 py-4 whitespace-nowrap">Mar 2026</td>
                                    <td class="px-5 py-4 whitespace-nowrap"><span class="px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Achievable</span></td>
                                </tr>
                                <tr class="table-row-even goal-row" data-timeline="Long-Term">
                                    <td class="px-5 py-4 whitespace-nowrap">Buy Car</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹20,00,000</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹0</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹1,21,000</td>
                                    <td class="px-5 py-4 whitespace-nowrap">Jan 2027</td>
                                    <td class="px-5 py-4 whitespace-nowrap"><span class="px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full bg-orange-100 text-orange-800">Partially Achievable</span></td>
                                </tr>
                                <tr class="table-row-odd goal-row" data-timeline="Mid-Term">
                                    <td class="px-5 py-4 whitespace-nowrap">Buy Bike</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹3,00,000</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹0</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹33,000</td>
                                    <td class="px-5 py-4 whitespace-nowrap">Jun 2026</td>
                                    <td class="px-5 py-4 whitespace-nowrap"><span class="px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Achievable</span></td>
                                </tr>
                                <tr class="table-row-even goal-row" data-timeline="Long-Term">
                                    <td class="px-5 py-4 whitespace-nowrap">Hardik's Marriage</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹20,00,000</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹9,13,045</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹33,000</td>
                                    <td class="px-5 py-4 whitespace-nowrap">Jan 2028</td>
                                    <td class="px-5 py-4 whitespace-nowrap"><span class="px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Achievable</span></td>
                                </tr>
                                <tr class="table-row-odd goal-row" data-timeline="Long-Term">
                                    <td class="px-5 py-4 whitespace-nowrap">Buy Home</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹47,25,000</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹40,62,354</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹0</td>
                                    <td class="px-5 py-4 whitespace-nowrap">Jan 2027</td>
                                    <td class="px-5 py-4 whitespace-nowrap"><span class="px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Achievable</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- CASH FLOW PAGE -->
            <div id="pageCashflow" class="page-content">
                <h2 class="text-3xl font-semibold text-gray-800 mb-8">Cash Flow & Expenses</h2>
                <div class="mb-8 bg-white p-5 rounded-xl card-shadow">
                    <h3 class="text-xl font-semibold text-gray-700 mb-5">Monthly Expense Overview</h3>
                     <div class="overflow-x-auto">
                        <table class="min-w-full text-sm">
                            <thead class="table-header">
                                <tr>
                                    <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Category</th>
                                    <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Amount ₹</th>
                                    <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">% of Income</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <tr class="table-row-odd"><td class="px-5 py-3">Hardik's father's total</td><td class="px-5 py-3">₹50,000</td><td class="px-5 py-3">19.9%</td></tr>
                                <tr class="table-row-even"><td class="px-5 py-3">Remittance to mom</td><td class="px-5 py-3">₹5,000</td><td class="px-5 py-3">2.0%</td></tr>
                                <tr class="table-row-odd"><td class="px-5 py-3">Rent</td><td class="px-5 py-3">₹22,000</td><td class="px-5 py-3">8.8%</td></tr>
                                <tr class="table-row-even"><td class="px-5 py-3">Groceries</td><td class="px-5 py-3">₹10,500</td><td class="px-5 py-3">4.2%</td></tr>
                                <tr class="table-row-odd"><td class="px-5 py-3">Luxury expenses</td><td class="px-5 py-3">₹5,000</td><td class="px-5 py-3">2.0%</td></tr>
                                <tr class="table-row-even"><td class="px-5 py-3">Fuel</td><td class="px-5 py-3">₹3,000</td><td class="px-5 py-3">1.2%</td></tr>
                                <tr class="table-row-odd"><td class="px-5 py-3">Sports</td><td class="px-5 py-3">₹4,500</td><td class="px-5 py-3">1.8%</td></tr>
                                <tr class="table-row-even"><td class="px-5 py-3">Travelling</td><td class="px-5 py-3">₹6,000</td><td class="px-5 py-3">2.4%</td></tr>
                                <tr class="table-row-odd"><td class="px-5 py-3">Scooty maintenance</td><td class="px-5 py-3">₹200</td><td class="px-5 py-3">0.1%</td></tr>
                                <tr class="table-row-even"><td class="px-5 py-3">Medical expense</td><td class="px-5 py-3">₹500</td><td class="px-5 py-3">0.2%</td></tr>
                                <tr class="table-row-odd"><td class="px-5 py-3">Daily life</td><td class="px-5 py-3">₹5,250</td><td class="px-5 py-3">2.1%</td></tr>
                                <tr class="table-row-even"><td class="px-5 py-3">Entertainment (Movie)</td><td class="px-5 py-3">₹750</td><td class="px-5 py-3">0.3%</td></tr>
                                <tr class="table-row-odd"><td class="px-5 py-3">Contingency expense</td><td class="px-5 py-3">₹800</td><td class="px-5 py-3">0.3%</td></tr>
                                <tr class="table-row-even"><td class="px-5 py-3">Education Loan EMI</td><td class="px-5 py-3">₹15,500</td><td class="px-5 py-3">6.2%</td></tr>
                                <tr class="font-semibold bg-slate-50 table-row-even">
                                    <td class="px-5 py-3">Total Expenses</td>
                                    <td class="px-5 py-3">₹1,29,000</td>
                                    <td class="px-5 py-3">51.3%</td>
                                </tr>
                                <tr class="font-semibold bg-green-50 table-row-odd">
                                    <td class="px-5 py-3">Surplus</td>
                                    <td class="px-5 py-3">₹1,22,256</td>
                                    <td class="px-5 py-3">48.7%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-1 gap-5 md:gap-7 mb-8">
                    <div class="bg-white p-5 rounded-xl card-shadow">
                        <h3 class="text-xl font-semibold text-gray-700 mb-5">Current Month Expense Breakdown</h3>
                        <div class="chart-container"><canvas id="expenseBreakdownChart"></canvas></div>
                    </div>
                </div>
                 <div class="insight-box insight-box-blue card-shadow">
                    <h3 class="text-lg font-semibold text-blue-700 mb-2 flex items-center"><i class="fas fa-lightbulb fa-fw mr-2"></i>Insight</h3>
                    <p class="text-blue-600 text-sm">"Approximately 51% of income is committed to expenses and EMIs. The current monthly surplus is ₹1,22,256, offering excellent potential for increased investments towards goals."</p>
                </div>
            </div>

            <!-- LOANS PAGE -->
            <div id="pageLoans" class="page-content">
                <h2 class="text-3xl font-semibold text-gray-800 mb-8">Loans & Liabilities</h2>
                <div class="bg-white p-5 rounded-xl card-shadow mb-8">
                    <h3 class="text-xl font-semibold text-gray-700 mb-5">Loan Details</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full">
                            <thead class="table-header">
                                <tr>
                                    <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Loan</th>
                                    <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">EMI ₹</th>
                                    <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Rate %</th>
                                    <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Outstanding ₹</th>
                                    <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Ends</th>
                                </tr>
                            </thead>
                            <tbody class="text-sm">
                                <tr class="table-row-odd">
                                    <td class="px-5 py-4 whitespace-nowrap">Education Loan</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹15,500</td>
                                    <td class="px-5 py-4 whitespace-nowrap">9.0%</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹12,00,000</td>
                                    <td class="px-5 py-4 whitespace-nowrap">240 months</td>
                                </tr>
                                <tr class="font-semibold bg-slate-50 table-row-even">
                                    <td class="px-5 py-4 whitespace-nowrap">Total EMI</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹15,500/month</td>
                                    <td class="px-5 py-4 whitespace-nowrap text-gray-600" colspan="4">Avg. Interest Rate: ~9.0%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-1 gap-5 md:gap-7">
                    <div class="bg-white p-5 rounded-xl card-shadow">
                        <h3 class="text-xl font-semibold text-gray-700 mb-5">Outstanding per Loan</h3>
                        <div class="chart-container"><canvas id="outstandingLoanChart"></canvas></div>
                    </div>
                </div>
            </div>

            <!-- ASSETS PAGE -->
            <div id="pageAssets" class="page-content">
                <h2 class="text-3xl font-semibold text-gray-800 mb-8">Assets & Investments</h2>
                <div class="bg-white p-5 rounded-xl card-shadow mb-8">
                    <h3 class="text-xl font-semibold text-gray-700 mb-5">Portfolio Snapshot</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full">
                            <thead class="table-header">
                                <tr>
                                    <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Asset</th>
                                    <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Hardik Ganger ₹</th>
                                    <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Chandresh Gangar ₹</th>
                                    <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Total Value ₹</th>
                                </tr>
                            </thead>
                            <tbody class="text-sm">
                                <tr class="table-row-odd"><td class="px-5 py-4 whitespace-nowrap">Mutual Fund (Equity - Domestic)</td><td class="px-5 py-4 whitespace-nowrap">1,22,23,000</td><td class="px-5 py-4 whitespace-nowrap">0</td><td class="px-5 py-4 whitespace-nowrap">1,22,23,000</td></tr>
                                <tr class="table-row-even"><td class="px-5 py-4 whitespace-nowrap">Traditional Policy Surrender</td><td class="px-5 py-4 whitespace-nowrap">0</td><td class="px-5 py-4 whitespace-nowrap">73,408</td><td class="px-5 py-4 whitespace-nowrap">73,408</td></tr>
                                <tr class="table-row-odd"><td class="px-5 py-4 whitespace-nowrap">EPF</td><td class="px-5 py-4 whitespace-nowrap">16,800</td><td class="px-5 py-4 whitespace-nowrap">0</td><td class="px-5 py-4 whitespace-nowrap">16,800</td></tr>
                                <tr class="table-row-even"><td class="px-5 py-4 whitespace-nowrap">Bank Balance</td><td class="px-5 py-4 whitespace-nowrap">13,20,472</td><td class="px-5 py-4 whitespace-nowrap">0</td><td class="px-5 py-4 whitespace-nowrap">13,20,472</td></tr>
                                <tr class="table-row-odd"><td class="px-5 py-4 whitespace-nowrap">Direct Equity (US)</td><td class="px-5 py-4 whitespace-nowrap">2,50,000</td><td class="px-5 py-4 whitespace-nowrap">0</td><td class="px-5 py-4 whitespace-nowrap">2,50,000</td></tr>
                                <tr class="table-row-even"><td class="px-5 py-4 whitespace-nowrap">Direct Equity (Indian)</td><td class="px-5 py-4 whitespace-nowrap">19,12,852</td><td class="px-5 py-4 whitespace-nowrap">0</td><td class="px-5 py-4 whitespace-nowrap">19,12,852</td></tr>
                                <tr class="table-row-odd"><td class="px-5 py-4 whitespace-nowrap">LIC Jeevan Anand</td><td class="px-5 py-4 whitespace-nowrap">4,17,000</td><td class="px-5 py-4 whitespace-nowrap">0</td><td class="px-5 py-4 whitespace-nowrap">4,17,000</td></tr>
                                <tr class="table-row-even"><td class="px-5 py-4 whitespace-nowrap">LIC Jeevan Labh</td><td class="px-5 py-4 whitespace-nowrap">4,98,000</td><td class="px-5 py-4 whitespace-nowrap">0</td><td class="px-5 py-4 whitespace-nowrap">4,98,000</td></tr>
                                <tr class="table-row-odd"><td class="px-5 py-4 whitespace-nowrap">Real Estate</td><td class="px-5 py-4 whitespace-nowrap">75,00,000</td><td class="px-5 py-4 whitespace-nowrap">0</td><td class="px-5 py-4 whitespace-nowrap">75,00,000</td></tr>
                                <tr class="table-row-even"><td class="px-5 py-4 whitespace-nowrap">PG Deposit</td><td class="px-5 py-4 whitespace-nowrap">19,500</td><td class="px-5 py-4 whitespace-nowrap">0</td><td class="px-5 py-4 whitespace-nowrap">19,500</td></tr>
                                <tr class="table-row-odd"><td class="px-5 py-4 whitespace-nowrap">TATA AIA</td><td class="px-5 py-4 whitespace-nowrap">0</td><td class="px-5 py-4 whitespace-nowrap">2,40,881</td><td class="px-5 py-4 whitespace-nowrap">2,40,881</td></tr>
                            </tbody>
                            <tfoot class="bg-slate-50 font-semibold text-gray-700">
                                <tr><td class="px-5 py-3 text-sm" colspan="4">Total Equity: ₹1,43,85,852</td></tr>
                                <tr><td class="px-5 py-3 text-sm" colspan="4">Total Debt & Other: ₹1,00,86,061</td></tr>
                                <tr><td class="px-5 py-3 text-sm font-bold" colspan="4">Grand Total: ₹2,44,71,913</td></tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
                 <div class="bg-white p-5 rounded-xl card-shadow">
                    <h3 class="text-xl font-semibold text-gray-700 mb-5">Asset Distribution</h3>
                    <div class="chart-container"><canvas id="assetClassChart"></canvas></div>
                </div>
            </div>

            <!-- RETIREMENT PAGE -->
            <div id="pageRetirement" class="page-content">
                <h2 class="text-3xl font-semibold text-gray-800 mb-8">Retirement Simulator</h2>
                <div class="grid grid-cols-1 lg:grid-cols-5 gap-6 mb-8">
                    <div class="lg:col-span-2 bg-white p-5 rounded-xl card-shadow">
                        <h3 class="text-xl font-semibold text-gray-700 mb-5">Retirement Forecast</h3>
                        <ul class="space-y-3 text-sm text-gray-600">
                            <li class="flex justify-between"><span>Required Corpus:</span> <strong id="reqCorpus" class="text-gray-800">₹7,99,90,265</strong></li>
                            <li class="flex justify-between"><span>Current Corpus:</span> <strong id="currCorpus" class="text-gray-800">₹12,95,026</strong></li>
                            <li class="flex justify-between"><span>Projected (at <span id="projReturnRate" class="font-semibold">12</span>%):</span> <strong id="projCorpus" class="text-gray-800">₹1,26,07,930</strong></li>
                            <li class="flex justify-between"><span>SIP Gap:</span> <strong id="sipGapRet" class="text-green-600">₹0/m</strong></li>
                            <li class="flex justify-between"><span>Retirement in:</span> <strong id="retYears" class="text-gray-800">22 years</strong></li>
                            <li class="pt-2 flex justify-between items-center"><span>Funding Status:</span> <strong id="fundingStatus" class="text-lg text-red-500">~16%</strong></li>
                        </ul>
                    </div>
                    <div class="lg:col-span-3 bg-white p-5 rounded-xl card-shadow">
                        <h3 class="text-xl font-semibold text-gray-700 mb-5">What-If Tools</h3>
                        <!-- Keep all the sliders disabled and set the initial value accordingly -->
                        <div class="space-y-5">
                            <div class="slider-container">
                                <label for="sipSlider">Adjust SIP (₹):</label>
                                <input type="range" id="sipSlider" name="sipSlider" min="20000" max="50000" value="32000" step="1000" class="w-full"  disabled>
                                <span id="sipSliderValue">₹32,000</span>
                            </div>
                            <div class="slider-container">
                                <label for="retAgeSlider">Retirement Age:</label>
                                <input type="range" id="retAgeSlider" name="retAgeSlider" min="45" max="65" value="50" step="1" disabled>
                                <span id="retAgeSliderValue">50 yrs</span>
                            </div>
                             <div class="slider-container">
                                <label for="inflationToggle">Inflation (%):</label>
                                <input type="range" id="inflationToggle" name="inflationToggle" min="4" max="8" value="5" step="0.5" disabled>
                                 <span id="inflationToggleValue">5.0%</span>
                            </div>
                        </div>
                        <button class="mt-6 w-full bg-sky-600 hover:bg-sky-700 text-white py-2.5 px-4 rounded-lg text-sm font-medium transition-colors" onclick="simulateRetirement()">Recalculate Projection</button>
                    </div>
                </div>
                <div class="bg-white p-5 rounded-xl card-shadow mb-8">
                    <h3 class="text-xl font-semibold text-gray-700 mb-5">Expense Projection Post-Retirement</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full">
                            <thead class="table-header">
                                <tr>
                                    <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Age</th>
                                    <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Expense p.a. ₹</th>
                                    <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Corpus Remaining ₹</th>
                                </tr>
                            </thead>
                            <!-- Always show years 5 years apart, starting from retirement age -->
                            <tbody id="expenseProjectionTable" class="text-sm">
                                <tr class="table-row-odd"> <td class="px-5 py-4 whitespace-nowrap">50</td> <td class="px-5 py-4 whitespace-nowrap">₹35,62,501</td> <td class="px-5 py-4 whitespace-nowrap">₹8,66,85,180</td> </tr>
                                <tr class="table-row-even"> <td class="px-5 py-4 whitespace-nowrap">55</td> <td class="px-5 py-4 whitespace-nowrap">₹45,46,755</td> <td class="px-5 py-4 whitespace-nowrap">₹1,00,344,616</td> </tr>
                                <tr class="table-row-odd"> <td class="px-5 py-4 whitespace-nowrap">60</td> <td class="px-5 py-4 whitespace-nowrap">₹58,02,939</td> <td class="px-5 py-4 whitespace-nowrap">₹1,13,087,955</td> </tr>
                                <tr class="table-row-even"> <td class="px-5 py-4 whitespace-nowrap">65</td> <td class="px-5 py-4 whitespace-nowrap">₹74,06,185</td> <td class="px-5 py-4 whitespace-nowrap">₹1,22,524,545</td> </tr>
                                <tr class="table-row-odd"> <td class="px-5 py-4 whitespace-nowrap">70</td> <td class="px-5 py-4 whitespace-nowrap">₹94,52,377</td> <td class="px-5 py-4 whitespace-nowrap">₹1,24,628,997</td> </tr>
                                <tr class="table-row-even"> <td class="px-5 py-4 whitespace-nowrap">75</td> <td class="px-5 py-4 whitespace-nowrap">₹1,20,63,894</td> <td class="px-5 py-4 whitespace-nowrap">₹1,12,845,513</td> </tr>
                                <tr class="table-row-odd"> <td class="px-5 py-4 whitespace-nowrap">80</td> <td class="px-5 py-4 whitespace-nowrap">₹1,53,96,926</td> <td class="px-5 py-4 whitespace-nowrap">₹7,67,42,360</td> </tr>
                                <tr class="table-row-even"> <td class="px-5 py-4 whitespace-nowrap">85</td> <td class="px-5 py-4 whitespace-nowrap">₹1,96,50,813</td> <td class="px-5 py-4 whitespace-nowrap">₹0</td> </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="insight-box insight-box-yellow card-shadow">
                    <h3 class="text-lg font-semibold text-amber-700 mb-2 flex items-center"><i class="fas fa-chart-line fa-fw mr-2"></i>Insight</h3>
                    <p id="retirementInsight" class="text-amber-600 text-sm">"Currently, the retirement goal is significantly underfunded based on projections. The existing corpus and SIPs are not sufficient to meet the required amount. A substantial increase in monthly investments is required to bridge this gap."</p>
                </div>
            </div>

            <!-- DISCRETIONARY RETIREMENT PAGE -->
            <div id="pageDiscretionaryretirement" class="page-content">
                <h2 class="text-3xl font-semibold text-gray-800 mb-8">Discretionary Retirement (Travel & Hobbies)</h2>
                <div class="p-5 text-center text-gray-500">
                    No Discretionary Retirement plan found in the provided data.
                </div>
            </div>

            <!-- INSURANCE PAGE -->
            <div id="pageInsurance" class="page-content">
                <h2 class="text-3xl font-semibold text-gray-800 mb-8">Insurance & Risk Management</h2>
                <div class="bg-white p-5 rounded-xl card-shadow mb-8">
                    <h3 class="text-xl font-semibold text-gray-700 mb-5">Insurance Summary</h3>
                     <div class="overflow-x-auto">
                        <!-- INSURANCE SUMMARY TABLE -->
                        <table class="min-w-full">
                            <thead class="table-header">
                                <tr>
                                    <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Coverage Type</th>
                                    <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Required Cover ₹</th>
                                    <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Existing Cover ₹</th>
                                    <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Gap/Surplus ₹</th>
                                </tr>
                            </thead>
                            <tbody class="text-sm">
                                <tr class="table-row-odd">
                                    <td class="px-5 py-4 whitespace-nowrap">Life Insurance (Hardik)</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹1,59,17,400</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹0</td>
                                    <td class="px-5 py-4 whitespace-nowrap text-green-600 font-semibold">₹46,605 (Surplus)</td>
                                </tr>
                                <tr class="table-row-even">
                                    <td class="px-5 py-4 whitespace-nowrap">Life Insurance (Chandresh)</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹5,08,73,724</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹0</td>
                                    <td class="px-5 py-4 whitespace-nowrap text-green-600 font-semibold">₹12,70,00,000 (Surplus)</td>
                                </tr>
                                <tr class="table-row-odd">
                                    <td class="px-5 py-4 whitespace-nowrap">Health Insurance (Family Floater)</td>
                                    <td class="px-5 py-4 whitespace-nowrap">Adequate</td>
                                    <td class="px-5 py-4 whitespace-nowrap">₹8,00,000</td>
                                    <td class="px-5 py-4 whitespace-nowrap text-green-600 font-semibold">Sufficient Base</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="bg-white p-5 rounded-xl card-shadow mb-8">
                        <h3 class="text-xl font-semibold text-gray-700 mb-5">Human Life Value (HLV) - Hardik Ganger</h3>
                        <div class="overflow-x-auto">
                            <table class="min-w-full text-sm">
                                 <thead class="table-header">
                                    <tr>
                                        <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Component</th>
                                        <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Amount ₹</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-gray-200">
                                    <tr class="table-row-odd"><td class="px-5 py-3">Liabilities</td><td class="px-5 py-3">12,00,000</td></tr>
                                    <tr class="table-row-even"><td class="px-5 py-3">One Time Final Costs</td><td class="px-5 py-3">0</td></tr>
                                    <tr class="table-row-odd"><td class="px-5 py-3">Dependent Needs (PV)</td><td class="px-5 py-3">1,23,17,400</td></tr>
                                    <tr class="table-row-even"><td class="px-5 py-3">Goal Obligations (PV)</td><td class="px-5 py-3">24,00,000</td></tr>
                                    <tr class="font-semibold table-row bg-slate-50"><td class="px-5 py-3">Total Financial Need (A)</td><td class="px-5 py-3">1,59,17,400</td></tr>
                                    <tr class="table-row-odd"><td class="px-5 py-3">Less: Existing Life Insurance</td><td class="px-5 py-3">0</td></tr>
                                    <tr class="table-row-even"><td class="px-5 py-3">Less: Continuing Income</td><td class="px-5 py-3">0</td></tr>
                                    <tr class="table-row-odd"><td class="px-5 py-3">Less: Existing Assets</td><td class="px-5 py-3">1,59,64,005</td></tr>
                                    <tr class="font-semibold table-row bg-slate-50"><td class="px-5 py-3">Total Available Resources (B)</td><td class="px-5 py-3">1,59,64,005</td></tr>
                                    <tr class="font-bold text-green-600 bg-green-50 table-row"><td class="px-5 py-3">Net Insurance Surplus (B - A)</td><td class="px-5 py-3">46,605</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="bg-white p-5 rounded-xl card-shadow mb-8">
                        <h3 class="text-xl font-semibold text-gray-700 mb-5">Human Life Value (HLV) - Chandresh Gangar</h3>
                        <div class="overflow-x-auto">
                            <table class="min-w-full text-sm">
                                 <thead class="table-header">
                                    <tr>
                                        <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Component</th>
                                        <th class="px-5 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Amount ₹</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-gray-200">
                                    <tr class="table-row-odd"><td class="px-5 py-3">Liabilities</td><td class="px-5 py-3">12,00,000</td></tr>
                                    <tr class="table-row-even"><td class="px-5 py-3">One Time Final Costs</td><td class="px-5 py-3">0</td></tr>
                                    <tr class="table-row-odd"><td class="px-5 py-3">Dependent Needs (PV)</td><td class="px-5 py-3">4,72,73,724</td></tr>
                                    <tr class="table-row-even"><td class="px-5 py-3">Goal Obligations (PV)</td><td class="px-5 py-3">24,00,000</td></tr>
                                    <tr class="font-semibold table-row bg-slate-50"><td class="px-5 py-3">Total Financial Need (A)</td><td class="px-5 py-3">5,08,73,724</td></tr>
                                    <tr class="table-row-odd"><td class="px-5 py-3">Less: Existing Life Insurance</td><td class="px-5 py-3">0</td></tr>
                                    <tr class="table-row-even"><td class="px-5 py-3">Less: Continuing Income</td><td class="px-5 py-3">16,15,29,691</td></tr>
                                    <tr class="table-row-odd"><td class="px-5 py-3">Less: Existing Assets</td><td class="px-5 py-3">1,59,64,005</td></tr>
                                    <tr class="font-semibold table-row bg-slate-50"><td class="px-5 py-3">Total Available Resources (B)</td><td class="px-5 py-3">17,74,93,696</td></tr>
                                    <tr class="font-bold text-green-600 bg-green-50 table-row"><td class="px-5 py-3">Net Insurance Surplus (B - A)</td><td class="px-5 py-3">12,66,19,972</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                 <div class="insight-box insight-box-green card-shadow">
                    <h3 class="text-lg font-semibold text-green-700 mb-2 flex items-center"><i class="fas fa-check-circle fa-fw mr-2"></i>Advice</h3>
                    <p class="text-green-600 text-sm">"Based on the HLV calculation, there is a significant life insurance surplus for both individuals. The current financial resources appear more than sufficient to cover liabilities and future needs. The existing health insurance provides a good base cover."</p>
                </div>
            </div>
        
        
        </div>

        <!-- FOOTER for all pages -->
        <footer class="text-center p-5 text-sm text-gray-500 border-t border-gray-200">
            Interactive Dashboard Demo &copy; 2024-2025. For demonstration purposes only.
        </footer>
    </div>

    <!-- MODAL -->
    <div id="detailModal" class="fixed inset-0 bg-gray-800 bg-opacity-75 overflow-y-auto h-full w-full hidden flex items-center justify-center p-4 z-50">
        <div class="relative bg-white p-6 border-0 w-full max-w-lg shadow-xl rounded-lg">
            <div class="text-left">
                <div class="flex justify-between items-center mb-4 pb-3 border-b border-gray-200">
                    <h3 class="text-xl leading-6 font-semibold text-gray-800" id="modalTitle">Detail</h3>
                    <button id="closeModalButton" class="text-gray-400 hover:text-gray-600 transition-colors">
                        <i class="fas fa-times fa-lg"></i>
                    </button>
                </div>
                <div class="mt-2 py-3">
                    <p class="text-base text-gray-700 whitespace-pre-line" id="modalValue"></p>
                    <p class="text-sm text-gray-500 mt-4" id="modalDescription">(This is a demo. In a real dashboard, this could show a detailed breakdown, allow drillthrough, or present further actions.)</p>
                </div>
                <div id="modalFooterActions" class="mt-5 pt-4 border-t border-gray-200 text-right space-x-3">
                     <button id="modalGoToPageButton" class="hidden px-5 py-2 text-white text-sm font-medium rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500 transition-colors">
                        Go to Page
                    </button>
                    <button id="modalActionButton" class="px-5 py-2 bg-sky-600 text-white text-sm font-medium rounded-md shadow-sm hover:bg-sky-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-sky-500 transition-colors">
                        OK
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Store chart instances to destroy them before re-rendering if needed
        let charts = {};

        // Helper to format currency
        const formatCurrency = (value) => `₹${Number(value).toLocaleString('en-IN', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}`;
        const formatPercentage = (value) => `${Number(value).toFixed(1)}%`;


        // --- Page Navigation ---
        const navItems = document.querySelectorAll('#mainNav .nav-item');
        const pageContents = document.querySelectorAll('.page-content');

        function switchPage(pageId) {
            pageContents.forEach(page => {
                page.classList.remove('active');
                if (page.id === pageId) {
                    page.classList.add('active');
                }
            });
            navItems.forEach(nav => {
                nav.classList.remove('active');
                if (nav.dataset.page === pageId.replace('page', '').toLowerCase()) {
                    nav.classList.add('active');
                }
            });
            loadChartsForPage(pageId);
        }

        navItems.forEach(item => {
            item.addEventListener('click', function() {
                const targetPageId = 'page' + this.dataset.page.charAt(0).toUpperCase() + this.dataset.page.slice(1);
                switchPage(targetPageId);
            });
        });

        // --- Modal Logic ---
        const detailModal = document.getElementById('detailModal');
        const closeModalButton = document.getElementById('closeModalButton');
        const modalActionButton = document.getElementById('modalActionButton');
        const modalGoToPageButton = document.getElementById('modalGoToPageButton');
        const modalTitleElem = document.getElementById('modalTitle');
        const modalValueElem = document.getElementById('modalValue');
        const modalDescriptionElem = document.getElementById('modalDescription');

        function showModal(title, value, description, targetPage = null) {
            modalTitleElem.innerText = title;
            modalValueElem.innerHTML = value; // Using innerHTML for potential strong tags or line breaks
            modalDescriptionElem.innerText = description;

            if (targetPage) {
                modalGoToPageButton.classList.remove('hidden');
                modalGoToPageButton.onclick = () => {
                    switchPage(targetPage);
                    hideModal();
                };
            } else {
                modalGoToPageButton.classList.add('hidden');
                modalGoToPageButton.onclick = null;
            }

            detailModal.classList.remove('hidden');
            detailModal.classList.add('flex');
        }

        function hideModal() {
            detailModal.classList.add('hidden');
            detailModal.classList.remove('flex');
        }
        
        window.showKPIDetail = (title, value, description, targetPage = null) => {
            showModal(title, `<strong>Value:</strong> ${value}`, description, targetPage);
        }
        window.drillthroughGoal = (goalName, details) => {
            showModal(`Goal Detail: ${goalName}`, details, "Further actions or detailed planning could be accessed here.");
        }
        window.showAssetDetail = (assetName, details) => {
            showModal(`Asset Detail: ${assetName}`, details, "Detailed view of the asset, performance, or related documents could be linked here.");
        }
        window.showLoanDetail = (loanName, details) => {
            showModal(`Loan Detail: ${loanName}`, details, "Review terms, prepayment options, or history.");
        }
        window.showInsuranceDetail = (insuranceType, details) => {
            showModal(`Insurance Detail: ${insuranceType}`, details, "Policy specifics, coverage terms, and recommendations.");
        }
        window.showHlvComponentDetail = (componentName, explanation) => {
            showModal(`HLV Component: ${componentName}`, explanation, "This is a key part of calculating your Human Life Value.");
        }
         window.showChartSegmentDetail = (chartTitle, segmentLabel, segmentValue, isPercentage = false) => {
            const formattedValue = isPercentage ? formatPercentage(segmentValue) : formatCurrency(segmentValue);
            showModal(
                `Detail: ${chartTitle}`, 
                `<strong>Segment:</strong> ${segmentLabel}\n<strong>Value:</strong> ${formattedValue}`,
                `This represents the '${segmentLabel}' portion of the '${chartTitle}'. Further drilldown could show underlying data.`
            );
        }


        closeModalButton.onclick = hideModal;
        modalActionButton.onclick = hideModal;
        window.onclick = (event) => {
            if (event.target == detailModal) {
                hideModal();
            }
        }

        // --- Chart.js Common Config ---
        const commonChartOptions = (chartTitle) => ({ // Added chartTitle parameter
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: { padding: 20, font: { size: 12, family: 'Inter' }, color: '#4b5563' }
                },
                title: { display: false },
                tooltip: {
                    backgroundColor: '#1f2937', 
                    titleColor: '#e5e7eb',
                    bodyColor: '#d1d5db',
                    titleFont: { family: 'Inter', weight: '600', size: 13 },
                    bodyFont: { family: 'Inter', size: 12 },
                    padding: 10,
                    cornerRadius: 4,
                    displayColors: true,
                    borderColor: '#374151',
                    borderWidth: 1,
                    callbacks: {
                        label: function(context) {
                            let label = context.dataset.label || context.label || '';
                            if (label) { label += ': '; }
                            let value = 0;
                            if (context.parsed.y !== null && context.parsed.y !== undefined) {
                                value = context.parsed.y;
                            } else if (context.parsed !== null && context.parsed !== undefined && !isNaN(context.parsed)) {
                                value = context.parsed;
                            }
                            
                            if (context.dataset.isPercentage) {
                                 label += formatPercentage(value);
                            } else {
                                 label += formatCurrency(value);
                            }
                            return label;
                        }
                    }
                }
            },
            onClick: (event, elements) => {
                if (elements.length > 0) {
                    const chart = event.chart;
                    const element = elements[0];
                    const label = chart.data.labels[element.index];
                    const value = chart.data.datasets[element.datasetIndex].data[element.index];
                    const isPercentage = chart.data.datasets[element.datasetIndex].isPercentage || false;
                    // Use the passed chartTitle for the modal
                    showChartSegmentDetail(chartTitle, label, value, isPercentage);
                }
            }
        });
        
        function destroyChart(chartId) {
            if (charts[chartId]) {
                charts[chartId].destroy();
                delete charts[chartId];
            }
        }

        // --- Chart Implementations ---
        function initSummaryCharts() {
            destroyChart('assetAllocationChart');
            const assetCtx = document.getElementById('assetAllocationChart').getContext('2d');
            charts['assetAllocationChart'] = new Chart(assetCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Equity', 'Debt & Other'], 
                    datasets: [{ 
                        label: 'Asset Allocation', 
                        data: [84.8, 15.2], 
                        backgroundColor: ['#38bdf8', '#fbbf24'], 
                        borderColor: ['#ffffff'], borderWidth: 3, 
                        isPercentage: true, hoverOffset: 8,
                        hoverBorderColor: '#f1f5f9'
                    }]
                },
                options: {...commonChartOptions('Asset Allocation'), cutout: '60%'}
            });

            destroyChart('liabilitiesChart');
            const liabilitiesCtx = document.getElementById('liabilitiesChart').getContext('2d');
            charts['liabilitiesChart'] = new Chart(liabilitiesCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Education Loan'],
                    datasets: [{ 
                        label: 'Liabilities', 
                        data: [1200000], 
                        backgroundColor: ['#f472b6'], 
                        borderColor: ['#ffffff'], borderWidth: 3, 
                        hoverOffset: 8,
                        hoverBorderColor: '#f1f5f9'
                     }]
                },
                options: {...commonChartOptions('Liabilities Overview'), cutout: '60%'}
            });
        }

        function initCashflowCharts() {
            destroyChart('expenseBreakdownChart');
            const breakdownCtx = document.getElementById('expenseBreakdownChart').getContext('2d');
            charts['expenseBreakdownChart'] = new Chart(breakdownCtx, {
                type: 'pie',
                data: {
                    labels: ['Essential', 'Discretionary', 'EMI'],
                    datasets: [{ 
                        label: 'Expense Breakdown', 
                        data: [100950, 12550, 15500], 
                        backgroundColor: ['#60a5fa', '#fbbf24', '#f472b6'], 
                        borderColor: ['#ffffff'], borderWidth: 3, hoverOffset: 8, hoverBorderColor: '#f1f5f9'
                    }]
                },
                options: commonChartOptions('Current Month Expense Breakdown')
            });
        }

        function initLoanCharts() {
            destroyChart('outstandingLoanChart');
            const outstandingCtx = document.getElementById('outstandingLoanChart').getContext('2d');
            charts['outstandingLoanChart'] = new Chart(outstandingCtx, {
                type: 'bar',
                data: {
                    labels: ['Education Loan'],
                    datasets: [{ 
                        label: 'Outstanding Amount', 
                        data: [1200000], 
                        backgroundColor: ['#f472b6'], 
                        borderRadius: 4
                    }]
                },
                options: { ...commonChartOptions('Outstanding per Loan'), indexAxis: 'y', scales: { x: { grid: { color: '#e5e7eb' }, ticks: { callback: value => formatCurrency(value) } }, y: { grid: { display: false } } }, interaction: { mode: 'index', intersect: false } }
            });
        }
        
        function initAssetsCharts() {
            destroyChart('assetClassChart');
            const assetClassCtx = document.getElementById('assetClassChart').getContext('2d');
            charts['assetClassChart'] = new Chart(assetClassCtx, {
                type: 'pie',
                data: {
                    labels: ['MF (Equity)', 'Real Estate', 'Direct Equity (Indian)', 'Bank Balance', 'LIC Policies', 'Other'],
                    datasets: [{ 
                        label: 'Asset Distribution', 
                        data: [12223000, 7500000, 1912852, 1320472, 915000, 580589], 
                        backgroundColor: ['#38bdf8', '#fbbf24', '#34d399', '#a78bfa', '#f472b6', '#fdba74'], 
                        borderColor: ['#ffffff'], borderWidth: 3,
                        hoverOffset: 8, hoverBorderColor: '#f1f5f9'
                    }]
                },
                options: commonChartOptions('Asset Distribution')
            });
        }


        // --- Page Specific Logic ---
        window.applyGoalTimelineSlicer = (timelineValue, clickedButton) => {
            // Visually update active button
            const slicerGroup = clickedButton.closest('.slicer-group');
            slicerGroup.querySelectorAll('.slicer-button').forEach(btn => btn.classList.remove('active'));
            clickedButton.classList.add('active');

            // Simulate table filtering
            const tableRows = document.querySelectorAll('#goalMetricsTable tbody .goal-row');
            tableRows.forEach(row => {
                if (timelineValue === 'All' || row.dataset.timeline === timelineValue) {
                    row.classList.remove('hidden-by-filter');
                } else {
                    row.classList.add('hidden-by-filter');
                }
            });
        };


        const sipSlider = document.getElementById('sipSlider');
        const retAgeSlider = document.getElementById('retAgeSlider');
        const inflationToggle = document.getElementById('inflationToggle');
        const sipSliderValue = document.getElementById('sipSliderValue');
        const retAgeSliderValue = document.getElementById('retAgeSliderValue');
        const inflationToggleValue = document.getElementById('inflationToggleValue');
        
        const reqCorpusElem = document.getElementById('reqCorpus');
        const currCorpusElem = document.getElementById('currCorpus');
        const projReturnRateElem = document.getElementById('projReturnRate');
        const projCorpusElem = document.getElementById('projCorpus');
        const sipGapRetElem = document.getElementById('sipGapRet');
        const retYearsElem = document.getElementById('retYears');
        const fundingStatusElem = document.getElementById('fundingStatus');
        const expenseProjectionTableBody = document.getElementById('expenseProjectionTable');
        const retirementInsightElem = document.getElementById('retirementInsight');
        const retirementInsightContainer = retirementInsightElem ? retirementInsightElem.parentElement : null;


        const initialRetirementData = {
            reqCorpusBase: 79990265, 
            currCorpus: 1295026,
            initialSip: 32000,
            initialRetAge: 50,
            currentAge: 28, 
            initialInflationRate: 0.05, 
            expectedReturnRate: 0.12,
            annualExpenseBase: 3562501
        };

        const initialDiscretionaryData = {
            reqCorpusBase: 0,
            currCorpus: 0,
            initialSip: 0,
            initialRetAge: 60,
            currentAge: 45,
            initialInflationRate: 0.05,
            expectedReturnRate: 0.10,
            annualExpenseBase: 0
        };

        function updateRetirementSliderValues(type = 'standard') {
            let sipSlider, retAgeSlider, inflationToggle;
            let sipSliderValue, retAgeSliderValue, inflationToggleValue;

            if (type === 'discretionary') {
                sipSlider = document.getElementById('discSipSlider');
                retAgeSlider = document.getElementById('discRetAgeSlider');
                inflationToggle = document.getElementById('discInflationToggle');
                sipSliderValue = document.getElementById('discSipSliderValue');
                retAgeSliderValue = document.getElementById('discRetAgeSliderValue');
                inflationToggleValue = document.getElementById('discInflationToggleValue');
            } else { // Default to standard
                sipSlider = document.getElementById('sipSlider');
                retAgeSlider = document.getElementById('retAgeSlider');
                inflationToggle = document.getElementById('inflationToggle');
                sipSliderValue = document.getElementById('sipSliderValue');
                retAgeSliderValue = document.getElementById('retAgeSliderValue');
                inflationToggleValue = document.getElementById('inflationToggleValue');
            }

            // Ensure elements exist before updating
            if (!sipSlider || !retAgeSlider || !inflationToggle || !sipSliderValue || !retAgeSliderValue || !inflationToggleValue) {
                // console.warn("Slider elements not found for type:", type);
                return;
            }

            sipSliderValue.textContent = formatCurrency(sipSlider.value);
            retAgeSliderValue.textContent = retAgeSlider.value + " yrs";
            inflationToggleValue.textContent = formatPercentage(inflationToggle.value);
        }

        
        if(sipSlider && retAgeSlider && inflationToggle) {
            sipSlider.oninput = () => updateRetirementSliderValues('standard');
            retAgeSlider.oninput = () => updateRetirementSliderValues('standard');
            inflationToggle.oninput = () => updateRetirementSliderValues('standard');
        }

        function calculateRetirementProjections(type = 'standard') {
            let data, sipSlider, retAgeSlider, inflationToggle;
            let reqCorpusElem, currCorpusElem, projReturnRateElem, projCorpusElem, sipGapRetElem, retYearsElem, fundingStatusElem;
            let expenseProjectionTableBody, insightElem, insightContainer;
            let currentAge, expectedReturnRate, reqCorpusBase, annualExpenseBase;

            if (type === 'discretionary') {
                // This section will not be used as there is no discretionary data
                return;
            } else {
                data = initialRetirementData;
                sipSlider = document.getElementById('sipSlider');
                retAgeSlider = document.getElementById('retAgeSlider');
                inflationToggle = document.getElementById('inflationToggle');
                reqCorpusElem = document.getElementById('reqCorpus');
                currCorpusElem = document.getElementById('currCorpus');
                projReturnRateElem = document.getElementById('projReturnRate');
                projCorpusElem = document.getElementById('projCorpus');
                sipGapRetElem = document.getElementById('sipGapRet');
                retYearsElem = document.getElementById('retYears');
                fundingStatusElem = document.getElementById('fundingStatus');
                expenseProjectionTableBody = document.getElementById('expenseProjectionTable');
                insightElem = document.getElementById('retirementInsight');
            }

            // Ensure core elements exist before proceeding
            if (!sipSlider || !retAgeSlider || !inflationToggle || !insightElem) {
                 // console.warn("Core calculation elements not found for type:", type);
                 return;
            }

            insightContainer = insightElem.parentElement; // Get the parent insight box
            currentAge = data.currentAge;
            expectedReturnRate = data.expectedReturnRate;
            reqCorpusBase = data.reqCorpusBase;
            annualExpenseBase = data.annualExpenseBase;


            const currentSip = parseInt(sipSlider.value);
            const retirementAge = parseInt(retAgeSlider.value);
            const inflationRate = parseFloat(inflationToggle.value) / 100;
            const annualReturnRate = expectedReturnRate;

            const yearsToRetirement = retirementAge - currentAge;
            if (retYearsElem) retYearsElem.textContent = `${yearsToRetirement} years`;

            let fvCurrentCorpus = data.currCorpus * Math.pow((1 + annualReturnRate), yearsToRetirement);

            let annualSip = currentSip * 12;
            let fvSips = 0;
            if (annualReturnRate > 0) {
                 fvSips = annualSip * ((Math.pow(1 + annualReturnRate, yearsToRetirement) - 1) / annualReturnRate) * (1 + annualReturnRate);
            } else {
                 fvSips = annualSip * yearsToRetirement;
            }

            let projectedTotalCorpus = fvCurrentCorpus + fvSips;
            if (projCorpusElem) projCorpusElem.textContent = formatCurrency(projectedTotalCorpus);
            if (projReturnRateElem) projReturnRateElem.textContent = expectedReturnRate * 100;
            
            let adjustedRequiredCorpus = reqCorpusBase; // Using the value from PDF directly
            if (reqCorpusElem) reqCorpusElem.textContent = formatCurrency(adjustedRequiredCorpus);

            let fundingPercentage = (projectedTotalCorpus / adjustedRequiredCorpus) * 100;
            if (fundingStatusElem) {
                fundingStatusElem.textContent = `~${Math.round(fundingPercentage)}%`;
                fundingStatusElem.className = fundingPercentage >= 100 ? "text-lg text-green-500 font-semibold" : (fundingPercentage >=70 ? "text-lg text-orange-500 font-semibold" : "text-lg text-red-500 font-semibold");
            }

            // This is a simplified simulation for demonstration.
            // The actual funding status and SIP gap would require more complex calculations.
            // We will use the values from the PDF for initial display.
        }


        window.simulateRetirement = (type = 'standard') => {
            alert("This is a demo feature. In a real application, this would re-run the projection calculations with the new inputs.");
            // calculateRetirementProjections(type); // This can be enabled for a live demo
        };

        function loadChartsForPage(pageId) {
            setTimeout(() => {
                if (pageId === 'pageSummary') initSummaryCharts();
                if (pageId === 'pageCashflow') initCashflowCharts();
                if (pageId === 'pageLoans') initLoanCharts();
                if (pageId === 'pageAssets') initAssetsCharts();
                if (pageId === 'pageRetirement') {
                    updateRetirementSliderValues();
                    // Initial calculation is based on PDF data, no need to call calculateRetirementProjections() on load
                }
            }, 100);
        }

        
        window.onload = function() {
            switchPage('pageSummary');
        };


    </script>
</body>
</html>